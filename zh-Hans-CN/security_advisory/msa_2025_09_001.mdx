---
title: MSA-2025-09-001
description: NFC 碰一碰（/api/device/content）IDOR 越权访问漏洞
---

**发布日期**: 2025 年 9 月 29 日  
**最后更新**: 2025 年 9 月 29 日  
**严重等级**: High  
**状态**: 已修复  
**CVSS 3.1 评分**: 8.3 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N)

---

## 概述

我们在 2025-09-29T02:56:00Z 收到关于 NFC“碰一碰”业务逻辑存在 IDOR 越权访问的安全报告。问题表现为服务端在仅凭已知 deviceId 的情况下，未对请求发起者进行有效认证与授权校验，导致攻击者可在掌握或猜测 deviceId 时读取用户设备屏幕内容。

我们已完成修复并发布 App 1.1.0 版本与服务端改造，无证据显示该漏洞被恶意利用。

## 影响范围

| 项目           | 详情                                                      |
| -------------- | --------------------------------------------------------- |
| **受影响产品** | Dot App（NFC 碰一碰功能）                                 |
| **受影响版本** | App 1.0.x 及之前版本                                      |
| **修复版本**   | App 1.1.0（需同时配合最新服务端策略）                     |
| **受影响组件** | 内容读取 API 接口（`/api/device/content`）与 NFC 跳转链路 |
| **攻击向量**   | 网络（可在已知或枚举 deviceId 情况下发起）                |
| **所需权限**   | 无（修复前服务端对未认证请求可返回敏感内容）              |

## 技术描述

-   业务链路：NFC 标签中编码链接 https://dot.mindreset.cn/nfc?deviceId=xxxxxx，用户通过 NFC 碰一碰触发 App 打开该链接，App 解析 deviceId 并调用 /api/device/content 接口获取设备屏幕内容进行展示。
-   缺陷成因：接口仅凭 deviceId 返回屏幕内容，未对请求者进行 Authentication 与 Authorization，存在典型 IDOR 越权风险。
-   deviceId 潜在来源：社交平台图片泄露、不受信任网络环境暴露、极端情况下暴力枚举。

## 修复措施

为兼顾可用性与安全性，我们实施了 App 与服务端协同的权限控制模型（符合“知情同意”原则与 DAC 模型）：

-   App 端（自 1.1.0 起）

    -   新增“碰一碰访问权限”设置：
        -   允许所有人碰一碰
        -   只允许自己和分享的人碰一碰（默认）
    -   用户可随时调整，设置与设备内容访问策略绑定。

-   服务端
    -   弃用旧版 /api/device/content 接口，统一改造为 /api/action。
    -   对 /api/action 强制鉴权与授权，根据 App 端设置决定返回：
        -   当设为“只允许自己和分享的人”时，仅在认证通过且命中所有者或分享名单/有效分享令牌时返回内容；否则返回 403。
        -   当设为“允许所有人”时，提供受限内容并叠加风控（速率限制、异常检测、最小化返回字段）。
    -   同步实施防枚举与风控策略：速率限制、异常行为识别、签名/令牌有效期、最小化返回等。

## 影响评估

-   未发现恶意利用证据：日志未见异常批量访问与数据导出。

## 用户行动建议

-   建议所有用户将 App 升级至 1.1.0，并核对“碰一碰访问权限”设置是否符合个人期望（默认：只允许自己和分享的人）。
-   避免在公开场合分享包含 deviceId 的截图或链接；如需分享，请使用 App 内置分享能力（带有效期和签名的分享方式）。

## 致谢

我们衷心感谢 [Mason](https://mas0n.org) 通过负责任的安全披露方式报告此问题，并在修复过程中提供了宝贵的验证协助。这种合作精神有助于保护所有用户的数据安全。

---

**免责声明**: 本公告基于当前可获得的信息编制。我们将持续监控相关威胁情报，如有重大更新将及时修订本公告。  
**文档编号**: MSA-2025-09-001  
**分类等级**: 公开  
**发布机构**: MindReset 安全团队
