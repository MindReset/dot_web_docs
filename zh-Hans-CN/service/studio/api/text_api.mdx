---
title: 文本
---

import Link from 'fumadocs-core/link';
import { Tab, Tabs } from 'fumadocs-ui/components/tabs';
import { TypeTable } from 'src/shadcn/components/type-table';

## 快速指引

### 必要条件

1. 确保您已在 Dot. App 中<Link href="/docs/service/studio/api/get_api">获取并保存了 API 密钥</Link>；
2. 确保您至少有一台所属于自己的设备并已<Link href="/docs/service/studio/api/get_device_id">获取设备序列号</Link>；
3. 确保您的设备已接入电源；
4. 确保您的设备已接入网络；
5. 确保设备已添加 `文本 API` 内容。

<Callout
	type="info"
	title="API 的请求限制为每秒 10 次，通过 API 请求，您可以更灵活地控制设备的行为和响应。"
/>

<Callout
	type="info"
	title="文档中的 ‘{{变量}}’ 花括号表示需要替换的变量，请根据实际情况进行替换，并移除‘{{}}’。"
/>

### 请求示例

<Tabs items={['cURL', 'Python', 'JavaScript', 'TypeScript', 'Go', 'Rust']}>
  <Tab value="cURL">
    ```bash
    curl -X POST \
      https://dot.mindreset.tech/api/authV2/open/device/text \
      -H 'Authorization: Bearer {{API_KEY}}' \
      -H 'Content-Type: application/json' \
      -d '{
        "refreshNow": {{是否立刻显示内容}},
        "deviceId": "{{设备序列号}}",
        "title": "{{标题}}",
        "message": "{{内容}}",
        "signature": "{{签名}}",
        "icon": "{{base64 编码 PNG 图标数据}}",
        "link": "{{碰一碰跳转链接}}"
      }'
    ```
  </Tab>
  <Tab value="Python">
    ```python
    import requests

    url = "https://dot.mindreset.tech/api/authV2/open/device/text"
    headers = {
        "Authorization": "Bearer {{API_KEY}}",
        "Content-Type": "application/json"
    }
    data = {
        "refreshNow": {{是否立刻显示内容}},
        "deviceId": "{{设备序列号}}",
        "title": "{{标题}}",
        "message": "{{内容}}",
        "signature": "{{签名}}",
        "icon": "{{base64 编码 PNG 图标数据}}",
        "link": "{{碰一碰跳转链接}}"
    }
    response = requests.post(url, json=data, headers=headers)
    print(response.json())
    ```

  </Tab>
  <Tab value="JavaScript">
    ```javascript
    fetch("https://dot.mindreset.tech/api/authV2/open/device/text", {
      method: "POST",
      headers: {
        "Authorization": "Bearer {{API_KEY}}",
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        refreshNow: {{是否立刻显示内容}},
        deviceId: "{{设备序列号}}",
        title: "{{标题}}",
        message: "{{内容}}",
        signature: "{{签名}}",
        icon: "{{base64 编码 PNG 图标数据}}",
        link: "{{碰一碰跳转链接}}"
      })
    }).then(res => res.json()).then(console.log);
    ```
  </Tab>
  <Tab value="TypeScript">
    ```typescript
    type ApiResponse = {
      code: number;
      message: string;
      result?: any;
    };

    fetch("https://dot.mindreset.tech/api/authV2/open/device/text", {
      method: "POST",
      headers: {
        "Authorization": "Bearer {{API_KEY}}",
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        refreshNow: {{是否立刻显示内容}},
        deviceId: "{{设备序列号}}",
        title: "{{标题}}",
        message: "{{内容}}",
        signature: "{{签名}}",
        icon: "{{base64 编码 PNG 图标数据}}",
        link: "{{碰一碰跳转链接}}"
      })
    })
      .then(res => res.json() as Promise<ApiResponse>)
      .then(data => {
        console.log(data);
      });
    ```

  </Tab>
  <Tab value="Go">
    ```go
    package main

    import (
      "bytes"
      "encoding/json"
      "fmt"
      "net/http"
      "io/ioutil"
    )

    func main() {
      url := "https://dot.mindreset.tech/api/authV2/open/device/text"
      payload := map[string]interface{}{
        "refreshNow": {{是否立刻显示内容}},
        "deviceId": "{{设备序列号}}",
        "title": "{{标题}}",
        "message": "{{内容}}",
        "signature": "{{签名}}",
        "icon": "{{base64 编码 PNG 图标数据}}",
        "link": "{{碰一碰跳转链接}}"
      }
      body, _ := json.Marshal(payload)
      req, _ := http.NewRequest("POST", url, bytes.NewBuffer(body))
      req.Header.Set("Authorization", "Bearer {{API_KEY}}")
      req.Header.Set("Content-Type", "application/json")
      client := &http.Client{}
      resp, _ := client.Do(req)
      defer resp.Body.Close()
      respBody, _ := ioutil.ReadAll(resp.Body)
      fmt.Println(string(respBody))
    }
    ```

  </Tab>
  <Tab value="Rust">
    ```rust
    use reqwest::blocking::Client;
    use serde_json::json;

    fn main() {
        let client = Client::new();
        let url = "https://dot.mindreset.tech/api/authV2/open/device/text";
        let res = client.post(url)
            .header("Authorization", "Bearer {{API_KEY}}")
            .header("Content-Type", "application/json")
            .json(&json!({
                "refreshNow": {{是否立刻显示内容}},
                "deviceId": "{{设备序列号}}",
                "title": "{{标题}}",
                "message": "{{内容}}",
                "signature": "{{签名}}",
                "icon": "{{base64 编码 PNG 图标数据}}",
                "link": "{{碰一碰跳转链接}}"
            }))
            .send()
            .unwrap()
            .text()
            .unwrap();
        println!("{}", res);
    }
    ```

  </Tab>
</Tabs>

### 响应示例

```json
{
	"code": 200,
	"message": "设备文本 API 内容已切换",
	"result": {
		"message": "设备 ABCD1234ABCD 文本 API 内容已切换"
	}
}
```

## 参考使用

1. 简单文本但不立刻显示

<CustomCloudImage osSrc="dot/docs/1_1754308279592.png" alt="实际效果" />

<Tabs items={['cURL']}>
  <Tab value="cURL">
    ```bash
    curl -X POST \
      https://dot.mindreset.tech/api/authV2/open/device/text \
      -H 'Authorization: Bearer dot_app_UlSpzXNEXhYZIAFakHLCkMVVBLbsBIWxaRMVaJZGUOYKhDoDRZwLLvLujAIwQxbY' \
      -H 'Content-Type: application/json' \
      -d '{
        "refreshNow": false,
        "deviceId": "ABCD1234ABCD",
        "title": "evnydd0sf",
        "message": "我能吞下玻璃而不伤身体"
      }'
    ```
  </Tab>
</Tabs>

2. 复杂文本并立即显示

<CustomCloudImage osSrc="dot/docs/2_1754308783977.png" alt="实际效果" />

<Tabs items={['cURL']}>
  <Tab value="cURL">
    ```bash
    curl -X POST \
      https://dot.mindreset.tech/api/authV2/open/device/text \
      -H 'Authorization: Bearer dot_app_UlSpzXNEXhYZIAFakHLCkMVVBLbsBIWxaRMVaJZGUOYKhDoDRZwLLvLujAIwQxbY' \
      -H 'Content-Type: application/json' \
      -d '{
        "deviceId": "ABCD1234ABCD",
        "title": "验证码小助手",
        "message": "一个来自「少数派」的验证码\n205112",
        "signature": "2025年8月4日 19:58"
      }'
    ```
  </Tab>
</Tabs>

3. 带有图标与链接的复杂文本并立即显示

<CustomCloudImage osSrc="dot/docs/3_1754310143662.png" alt="实际效果" />

<Tabs items={['cURL']}>
  <Tab value="cURL">
    ```bash
    curl -X POST \
      https://dot.mindreset.tech/api/authV2/open/device/text \
      -H 'Authorization: Bearer dot_app_UlSpzXNEXhYZIAFakHLCkMVVBLbsBIWxaRMVaJZGUOYKhDoDRZwLLvLujAIwQxbY' \
      -H 'Content-Type: application/json' \
      -d '{
        "deviceId": "ABCD1234ABCD",
        "title": "每日健康",
        "message": "消耗卡路里：702千卡\n今日步数：4183步\n站立时间：62分钟",
        "signature": "2025年8月4日 20:16",
        "icon": "{{base64 编码 PNG 图像数据}}",
        "link": "x-apple-health://"
      }'
    ```
  </Tab>
</Tabs>

4. 高度自定义的文本或图形

<Link href="/docs/service/studio/api/image_api#%E5%8F%82%E8%80%83%E4%BD%BF%E7%94%A8">
	请参考图像 API 中文本图像的使用方法
</Link>

<CustomCloudImage osSrc="dot/docs/%E9%98%B4%E5%BD%B13_1754130631116.png" alt="实际效果" />

## 问题排查

### 请求路径

`/api/authV2/open/device/text`

### 请求方法

`POST`

### 请求结构

<TypeTable
	type={{
		refreshNow: {
			description: '是否立刻显示内容（控制内容的显示时机）',
			type: 'bool',
			default: 'true',
		},
		deviceId: {
			description: '设备序列号（分辨不同的设备）',
			type: 'string',
			required: true,
		},
		title: {
			description: '文本标题（显示在屏幕上的标题）',
			type: 'string',
		},
		message: {
			description: '文本内容（显示在屏幕上的内容）',
			type: 'string',
		},
		signature: {
			description: '文本签名（显示在屏幕上的签名）',
			type: 'string',
		},
		icon: {
			description: 'base64 编码 PNG 图标数据（40px×40px）（显示在屏幕左下角上的图标）',
			type: 'string',
		},
		link: {
			description: 'http/https 链接或 Scheme Url（碰一碰跳转的内容）',
			type: 'string',
		},
	}}
/>

### 响应结构

<TypeTable
	type={{
		code: {
			description: '状态码',
			type: 'number',
			required: true,
		},
		message: {
			description: '响应描述',
			type: 'string',
			required: true,
		},
	}}
/>

### 响应说明

| code  | 含义             | 描述                                           |
| ----- | ---------------- | ---------------------------------------------- |
| `200` | 成功             | 设备文本 API 内容已切换/数据已更新但未切换内容 |
| `400` | 参数错误         | 无效的图标格式                                 |
| `403` | 权限不足         | 您没有权限操作此设备                           |
| `404` | 设备或内容不存在 | 设备不存在或未注册<br/>未添加文本 API 内容     |
| `500` | 设备响应失败     | 设备文本 API 内容切换失败                      |
