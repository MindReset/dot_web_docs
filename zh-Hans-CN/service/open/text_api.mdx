---
title: 控制文本内容
---

import Link from 'fumadocs-core/link';
import { Tab, Tabs } from 'fumadocs-ui/components/tabs';
import { ApiPlayground } from 'src/shadcn/components/api-playground';
import { TypeTable } from 'src/shadcn/components/type-table';

<Callout type="warning" title="接口迁移提示">
	旧版接口 `https://dot.mindreset.tech/api/open/text` 即将停止维护。
	为了降低迁移成本，我们会将发往旧版接口的请求自动转发到新版接口，但该兼容行为可能在未来移除。

    建议您尽快完成以下调整：
    - 将请求地址更新为新版接口：`/api/authV2/open/device/:deviceId/text`
    - 按本文档的请求结构发送参数（例如 `refreshNow` / `title` / `message` / `signature` / `icon` / `link` / `taskKey`）
    - 如您依赖旧版接口的返回内容或错误码，请以新版接口的响应为准进行适配

</Callout>

## 快速指引

### 必要条件

1. 确保您已在 Dot. App 中<Link href="/docs/service/studio/api/get_api">获取并保存了 API 密钥</Link>；
2. 确保您至少有一台所属于自己的设备并已<Link href="/docs/service/studio/api/get_device_id">获取设备序列号</Link>；
3. 确保您的设备已接入电源；
4. 确保您的设备已接入网络；
5. 确保设备已添加 `文本 API` 内容。

<Callout
	type="info"
	title="API 的请求限制为每秒 10 次，通过 API 请求，您可以更灵活地控制设备的行为和响应。"
/>

<Callout
	type="info"
	title="文档中的 ‘{{变量}}’ 花括号表示需要替换的变量，请根据实际情况进行替换，并移除‘{{}}’。"
/>

### 请求示例

<ApiPlayground
	baseUrl="https://dot.mindreset.tech"
	endpoint="/api/authV2/open/device/:deviceId/text"
	method="POST"
	pathParams={{
		deviceId: {
			type: 'string',
			required: true,
			name: '设备序列号',
		},
	}}
	bodyParams={{
		refreshNow: {
			type: 'boolean',
			name: '是否立刻显示内容',
			default: true,
		},
		taskKey: {
			type: 'string',
			name: '任务唯一标识',
			description:
				'可通过「列出设备任务」接口获取（当设备存在多个「文本 API」内容时用于指定目标内容）。',
		},
		title: {
			type: 'string',
			name: '标题',
		},
		message: {
			type: 'string',
			name: '内容',
		},
		signature: {
			type: 'string',
			name: '签名',
		},
		icon: {
			type: 'textarea',
			name: 'base64 编码 PNG 图标数据',
		},
		link: {
			type: 'string',
			name: '碰一碰跳转链接',
		},
	}}
	auth={true}
	defaultOpen={false}
/>

### 响应示例

```json
{
	"code": 200,
	"message": "设备文本 API 内容已切换",
	"result": {
		"message": "设备 ABCD1234ABCD 文本 API 内容已切换"
	}
}
```

## 参考使用

1. 简单文本但不立刻显示

<CustomCloudImage osSrc="dot/docs/1_1754308279592.png" alt="实际效果" />

<Tabs items={['cURL']}>
  <Tab value="cURL">
    ```bash
    curl -X POST \
		  https://dot.mindreset.tech/api/authV2/open/device/{{deviceId}}/text \
      -H 'Authorization: Bearer dot_app_UlSpzXNEXhYZIAFakHLCkMVVBLbsBIWxaRMVaJZGUOYKhDoDRZwLLvLujAIwQxbY' \
      -H 'Content-Type: application/json' \
      -d '{
        "refreshNow": false,
        "title": "evnydd0sf",
        "message": "我能吞下玻璃而不伤身体"
      }'
    ```
  </Tab>
</Tabs>

2. 复杂文本并立即显示

<CustomCloudImage osSrc="dot/docs/2_1754308783977.png" alt="实际效果" />

<Tabs items={['cURL']}>
  <Tab value="cURL">
    ```bash
    curl -X POST \
		  https://dot.mindreset.tech/api/authV2/open/device/{{deviceId}}/text \
      -H 'Authorization: Bearer dot_app_UlSpzXNEXhYZIAFakHLCkMVVBLbsBIWxaRMVaJZGUOYKhDoDRZwLLvLujAIwQxbY' \
      -H 'Content-Type: application/json' \
      -d '{
        "title": "验证码小助手",
        "message": "一个来自「少数派」的验证码\n205112",
        "signature": "2025年8月4日 19:58"
      }'
    ```
  </Tab>
</Tabs>

3. 带有图标与链接的复杂文本并立即显示

<CustomCloudImage osSrc="dot/docs/3_1754310143662.png" alt="实际效果" />

<Tabs items={['cURL']}>
  <Tab value="cURL">
    ```bash
    curl -X POST \
		  https://dot.mindreset.tech/api/authV2/open/device/{{deviceId}}/text \
      -H 'Authorization: Bearer dot_app_UlSpzXNEXhYZIAFakHLCkMVVBLbsBIWxaRMVaJZGUOYKhDoDRZwLLvLujAIwQxbY' \
      -H 'Content-Type: application/json' \
      -d '{
        "title": "每日健康",
        "message": "消耗卡路里：702千卡\n今日步数：4183步\n站立时间：62分钟",
        "signature": "2025年8月4日 20:16",
        "icon": "{{base64 编码 PNG 图像数据}}",
        "link": "x-apple-health://"
      }'
    ```
  </Tab>
</Tabs>

4. 高度自定义的文本或图形

<Link href="/docs/service/studio/api/image_api#%E5%8F%82%E8%80%83%E4%BD%BF%E7%94%A8">
	请参考图像 API 中文本图像的使用方法
</Link>

<CustomCloudImage osSrc="dot/docs/%E9%98%B4%E5%BD%B13_1754130631116.png" alt="实际效果" />

## 问题排查

### 请求路径

`/api/authV2/open/device/:deviceId/text`

### 请求方法

`POST`

### 请求结构

<TypeTable
	type={{
		refreshNow: {
			description: '是否立刻显示内容（控制内容的显示时机）',
			type: 'bool',
			default: 'true',
		},
		title: {
			description: '文本标题（显示在屏幕上的标题）',
			type: 'string',
		},
		message: {
			description: '文本内容（显示在屏幕上的内容）',
			type: 'string',
		},
		signature: {
			description: '文本签名（显示在屏幕上的签名）',
			type: 'string',
		},
		icon: {
			description: 'base64 编码 PNG 图标数据（40px×40px）（显示在屏幕左下角上的图标）',
			type: 'string',
		},
		link: {
			description: 'http/https 链接或 Scheme Url（碰一碰跳转的内容）',
			type: 'string',
		},
		taskKey: {
			description:
				'当设备存在多个「文本 API」内容时，用于指定要更新并切换的目标内容 taskKey。可通过「列出设备任务」获取。不传递则默认选择第一个文本 API 内容。',
			type: 'string',
		},
	}}
/>

### 响应结构

<TypeTable
	type={{
		code: {
			description: '状态码',
			type: 'number',
			required: true,
		},
		message: {
			description: '响应描述',
			type: 'string',
			required: true,
		},
	}}
/>

### 响应说明

| code  | 含义             | 描述                                           |
| ----- | ---------------- | ---------------------------------------------- |
| `200` | 成功             | 设备文本 API 内容已切换/数据已更新但未切换内容 |
| `400` | 参数错误         | 无效的图标格式                                 |
| `403` | 权限不足         | 您没有权限操作此设备                           |
| `404` | 设备或内容不存在 | 设备不存在或未注册<br/>未添加文本 API 内容     |
| `500` | 设备响应失败     | 设备文本 API 内容切换失败                      |
