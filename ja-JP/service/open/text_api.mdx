---
title: テキスト内容を制御
---

import Link from 'fumadocs-core/link';
import { Tab, Tabs } from 'fumadocs-ui/components/tabs';
import { ApiPlayground } from 'src/shadcn/components/api-playground';
import { TypeTable } from 'src/shadcn/components/type-table';

<Callout type="warning" title="API 移行のお知らせ">
	旧エンドポイント `https://dot.mindreset.tech/api/open/text` は近日中に廃止予定です。
	移行負担を軽減するため、旧エンドポイントへのリクエストは新しい API へ自動転送されますが、
	この互換動作は将来的に廃止される可能性があります。

    できるだけ早く以下の対応を行うことを強く推奨します：
    - リクエスト URL を新しいエンドポイントへ更新：`/api/authV2/open/device/:deviceId/text`
    - 本ドキュメントのリクエスト構造に従ってパラメータを送信（例：`refreshNow` / `title` / `message` / `signature` / `icon` / `link` / `taskKey`）
    - 旧版のレスポンス内容やエラーコードに依存している場合は、新版 API のレスポンスに合わせて調整

</Callout>

## クイックガイド

### 必要条件

1. Dot. アプリで<Link href="/docs/service/studio/api/get_api">API キーを取得して保存</Link>していること
2. 自分のデバイスが少なくとも 1 台あり、<Link href="/docs/service/studio/api/get_device_id">デバイスのシリアル番号</Link>を取得していること
3. デバイスが電源に接続されていること
4. デバイスがネットワークに接続されていること
5. Dot. アプリの創造所から「テキスト API」コンテンツをデバイスタスクに追加していること

<Callout
	type="info"
	title="APIのリクエスト制限は1秒あたり10回です。APIを使うとデバイスの動作と応答をより柔軟に制御できます。"
/>

<Callout
	type="info"
	title="ドキュメント中の「{{変数}}」は置換が必要なプレースホルダーです。実際の値に置き換え、「{{}}」は削除してください。"
/>

### リクエスト例

<ApiPlayground
	baseUrl="https://dot.mindreset.tech"
	endpoint="/api/authV2/open/device/:deviceId/text"
	method="POST"
	pathParams={{
		deviceId: {
			type: 'string',
			required: true,
			name: 'デバイスシリアル番号',
		},
	}}
	bodyParams={{
		refreshNow: {
			type: 'boolean',
			name: '内容を即時表示するか',
			default: true,
		},
		taskKey: {
			type: 'string',
			name: 'タスク識別子',
			description:
				'「デバイスタスク一覧」API で取得できます（複数の「テキスト API」コンテンツがある場合に対象を指定）。',
		},
		title: {
			type: 'string',
			name: 'タイトル',
		},
		message: {
			type: 'string',
			name: '内容',
		},
		signature: {
			type: 'string',
			name: '署名',
		},
		icon: {
			type: 'textarea',
			name: 'base64 エンコードした PNG アイコンデータ',
		},
		link: {
			type: 'string',
			name: 'タッチ操作時の遷移リンク',
		},
	}}
	auth={true}
	defaultOpen={false}
/>

### レスポンス例

```json
{
	"code": 200,
	"message": "デバイスのテキスト API コンテンツを切り替えました",
	"result": {
		"message": "デバイス ABCD1234ABCD のテキスト API コンテンツを切り替えました"
	}
}
```

## 参考ユースケース

1. シンプルなテキスト（即時表示しない）

<CustomCloudImage osSrc="dot/docs/1_1754308279592.png" alt="実際の効果" />

<Tabs items={['cURL']}>
  <Tab value="cURL">
    ```bash
    curl -X POST \
		  https://dot.mindreset.tech/api/authV2/open/device/{{deviceId}}/text \
      -H 'Authorization: Bearer dot_app_UlSpzXNEXhYZIAFakHLCkMVVBLbsBIWxaRMVaJZGUOYKhDoDRZwLLvLujAIwQxbY' \
      -H 'Content-Type: application/json' \
      -d '{
        "refreshNow": false,
        "title": "evnydd0sf",
        "message": "我能吞下玻璃而不伤身体"
      }'
    ```
  </Tab>
</Tabs>

2. 複雑なテキスト（即時表示）

<CustomCloudImage osSrc="dot/docs/2_1754308783977.png" alt="実際の効果" />

<Tabs items={['cURL']}>
  <Tab value="cURL">
    ```bash
    curl -X POST \
		  https://dot.mindreset.tech/api/authV2/open/device/{{deviceId}}/text \
      -H 'Authorization: Bearer dot_app_UlSpzXNEXhYZIAFakHLCkMVVBLbsBIWxaRMVaJZGUOYKhDoDRZwLLvLujAIwQxbY' \
      -H 'Content-Type: application/json' \
      -d '{
        "title": "验证码小助手",
        "message": "一个来自「少数派」的验证码\n205112",
		"signature": "2025 年 8 月 4 日 19:58"
      }'
    ```
  </Tab>
</Tabs>

3. アイコンとリンク付きの複雑テキスト（即時表示）

<CustomCloudImage osSrc="dot/docs/3_1754310143662.png" alt="実際の効果" />

<Tabs items={['cURL']}>
  <Tab value="cURL">
    ```bash
    curl -X POST \
		  https://dot.mindreset.tech/api/authV2/open/device/{{deviceId}}/text \
      -H 'Authorization: Bearer dot_app_UlSpzXNEXhYZIAFakHLCkMVVBLbsBIWxaRMVaJZGUOYKhDoDRZwLLvLujAIwQxbY' \
      -H 'Content-Type: application/json' \
      -d '{
        "title": "每日健康",
        "message": "消耗カロリー：702kcal\n本日の歩数：4183 歩\nスタンド時間：62 分",
		"signature": "2025 年 8 月 4 日 20:16",
        "icon": "{{base64 エンコードした PNG 画像データ}}",
        "link": "x-apple-health://"
      }'
    ```
  </Tab>
</Tabs>

4. 高度にカスタマイズしたテキストやグラフィック

<Link href="/docs/service/studio/api/image_api#%E5%8F%82%E8%80%83%E4%BD%BF%E7%94%A8">
	テキスト画像の利用方法は画像 API の該当セクションをご参照ください
</Link>

<CustomCloudImage osSrc="dot/docs/陰影3_1754130631116.png" alt="実際の効果" />

## トラブルシューティング

### リクエストパス

`/api/authV2/open/device/:deviceId/text`

### メソッド

`POST`

### リクエスト構造

<TypeTable
	type={{
		refreshNow: {
			description: 'コンテンツを即時に表示するか（表示タイミング制御）',
			type: 'bool',
			default: 'true',
		},
		title: {
			description: 'テキストのタイトル（画面上のタイトル）',
			type: 'string',
		},
		message: {
			description: 'テキスト本文（画面上の内容）',
			type: 'string',
		},
		signature: {
			description: '署名（画面上の署名）',
			type: 'string',
		},
		icon: {
			description: 'base64 エンコード PNG アイコン（40px×40px）（左下に表示するアイコン）',
			type: 'string',
		},
		link: {
			description: 'http/https またはスキーム URL（タッチ操作の遷移先）',
			type: 'string',
		},
		taskKey: {
			description:
				'デバイスに複数の「テキスト API」コンテンツがある場合、更新して切り替える対象を taskKey で指定します。taskKey は「デバイスタスク一覧」で取得できます。未指定の場合は最初のテキスト API コンテンツが選択されます。',
			type: 'string',
		},
	}}
/>

### レスポンス構造

<TypeTable
	type={{
		code: {
			description: 'ステータス',
			type: 'number',
			required: true,
		},
		message: {
			description: '応答説明',
			type: 'string',
			required: true,
		},
	}}
/>

### レスポンスコード

| code  | 意味             | 説明                                                |
| :---- | :--------------- | :-------------------------------------------------- |
| `200` | 成功             | テキスト API コンテンツを切替／データ更新（未切替） |
| `400` | パラメータ不正   | 無効なアイコン形式                                  |
| `403` | 権限不足         | 当該デバイスを操作する権限がありません              |
| `404` | 未検出           | デバイスが存在しない・未登録／テキスト API 未追加   |
| `500` | デバイス応答失敗 | テキスト API コンテンツの切替に失敗                 |
