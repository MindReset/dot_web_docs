---
title: MSA-2025-09-001 (JA)
description: NFC タップにおける IDOR 脆弱性
---

**公開日**: 2025 年 9 月 29 日  
**最終更新**: 2025 年 9 月 29 日  
**深刻度**: High  
**ステータス**: 修正済み  
**CVSS 3.1 スコア**: 8.3 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N)

---

## 概要

2025-09-29T02:56:00Z、NFC「タップ」フローにおいて IDOR（Insecure Direct Object Reference）脆弱性が報告されました。サーバーが提供された deviceId のみを根拠にリクエスト送信者の認証・認可を行わず画面内容を返却していたため、deviceId を把握または推測できる攻撃者がユーザーの画面内容を取得できる問題でした。

本件は修正済みで、アプリ版 1.1.0 を公開し、サーバー側の改修も展開済みです。悪用の証拠は確認されていません。

## 影響範囲

| 項目                   | 詳細                                                                     |
| ---------------------- | ------------------------------------------------------------------------ |
| **影響製品**           | Dot アプリ（NFC タップ機能）                                             |
| **影響バージョン**     | アプリ 1.0.x 以前                                                        |
| **修正バージョン**     | アプリ 1.1.0（最新サーバーポリシーとの併用が必要）                       |
| **影響コンポーネント** | コンテンツ取得 API（`/api/device/content`）および NFC リダイレクトフロー |
| **攻撃ベクトル**       | ネットワーク（deviceId を既知／推測可能な場合に悪用可能）                |
| **必要権限**           | なし（修正前は未認証でも機微情報が返却される可能性）                     |

## 技術的説明

-   フロー: NFC タグは https://dot.mindreset.cn/nfc?deviceId=xxxxxx のようなリンクをエンコード。タップによりアプリが起動し、deviceId を解析して `/api/device/content` にリクエストして画面内容を表示。
-   根本原因：API が deviceId のみで返却しており、認証・認可（Authentication / Authorization）が欠如していたため、典型的な IDOR リスクとなっていました。
-   deviceId の流出経路例：画像共有時のうっかり露出、不信頼ネットワークでの暴露、極端な場合は総当たり列挙。

## 修正内容

利便性と安全性の両立のため、インフォームド・コンセント原則および DAC（任意アクセス制御）に整合する、アプリとサーバーの協調モデルを導入しました。

-   アプリ側（1.1.0 以降）:
-   「タップ時のアクセス権限」設定を追加：
    -   すべての人に許可
    -   自分と共有相手のみ（デフォルト）
-   ユーザーは随時変更可能。設定はデバイスのコンテンツアクセス方針に紐づきます。

-   サーバー側:
-   コンテンツ取得時に認証・認可を必須化し、アプリ側設定に応じて返却内容を制御：
    -   「自分と共有相手のみ」の場合：認証済みかつ所有者または共有リスト／有効な共有トークンに一致したときのみ返却。条件不一致は 403。
    -   「すべての人に許可」の場合：最小限の内容を返却し、レート制限・異常検知などのリスク対策を適用。
-   併せて列挙対策とリスク管理を導入：レート制限、異常行動検知、署名／有効期限付きトークン、最小応答など。

## 影響評価

-   悪用の証拠はなし：ログに異常な大量アクセスや流出は確認されず。
-   修正後のリスク低減：デフォルトを「自分と共有相手のみ」とし、越権露出を大幅に抑制。
-   データ整合性への影響なし：読み取り経路のみの問題で、書き込みや主要ロジックに影響なし。

## ユーザーへのお願い

-   アプリを 1.1.0 にアップデートし、「タップ時のアクセス権限」設定（デフォルト：自分と共有相手のみ）をご確認ください。
-   deviceId を含むスクリーンショットやリンクの公開共有は避け、共有時は署名と有効期限付きのアプリ内共有機能をご利用ください。

## 謝辞

本件を責任ある開示でご報告いただき、修正検証にもご協力いただいた [Mason](https://mas0n.org) 様に深く感謝いたします。

---

**免責事項**：本アドバイザリは、現時点で入手可能な情報に基づき作成されています。関連する脅威インテリジェンスを継続的に監視し、重要な更新がある場合は速やかに改訂します。  
**文書番号**：MSA-2025-09-001  
**分類レベル**：公開  
**発行機関**：MindReset セキュリティチーム
